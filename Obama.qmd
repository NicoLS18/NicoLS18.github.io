---
title: "Obama"
execute: 
  warning: false
  message: false
---

```{r, echo=FALSE}
library(tidyverse)
library(ggplot2)
library(stringr)


```

The data used in this analysis comes from the Obama Presidential Library, specifically from their Digital Research Room. It is publicly available at:

ðŸ”— <https://www.obamalibrary.gov/digital-research-room/archived-white-house-websites-and-social-media>

The dataset is titled **`tweets.csv`**, which contains tweets posted from the official \@POTUS Twitter account during President Barack Obamaâ€™s administration. The dataset includes columns such as the text of each tweet, timestamp, and other metadata.

This analysis focuses primarily on the text column, which contains the actual content of the tweets. The goal is to examine how often President Obama mentioned key policy topics, such as healthcare, climate change, and the economy, over the course of his presidency.

```{r, echo=FALSE}
obama <- readr::read_csv('tweets.csv')




```

```{r, echo=FALSE}
cleanobama <- obama |>
  mutate(text = str_to_lower(text),
         text = str_replace_all(text, "http[[:alnum:][:punct:]]*", ""),  # Remove URLs
         text = str_replace_all(text, "[[:punct:]]", " "),
         text = str_replace_all(text, "â€”@POTUS.*", ""),
         text= str_replace_all(text, "\n", "")) 

# Define stopwords to exclude
stopwords <- c("the", "and", "to", "of", "in", "a", "on", "for", "with", "is", "that","s", "at", "potus", "  ", "rt", "amp", "it","this", "are","â†’")

# Tokenize the text, remove stopwords, and count word frequencies
word_counts <- cleanobama |>
  mutate(words = str_split(text, "\\s+")) |>  # Split text into words
  unnest(words) |>  # Convert list of words into individual rows
  filter(words != "", !words %in% stopwords) |>  # Exclude stopwords
  count(words, sort = TRUE)  # Count word frequencies


word_counts |>
  slice_max(n, n = 10) |>  # Get top 10 most frequent words
  ggplot(aes(x = reorder(words, n), y = n)) +
  geom_col(fill = "skyblue") +
  coord_flip() +
  labs(title = "Top 10 Words in Obama's Tweets",
       x = "Word",
       y = "Frequency")

```

This graph illustrates which words Obama used most throughout his presidency in his tweets while not including "the", "and", "to", "of", "in", "a", "on", "for", "with", "is", "that","s", "at", "potus", "rt", "amp", "it","this", "are" and "â†’".

```{r, echo=FALSE}




policy_keywords <- c("healthcare", "education", "climate", "economy", 
                     "jobs", "tax", "immigration", "gun", "poverty")


obama <- obama |>
  mutate(text = str_to_lower(text),  # stringr
         text = str_replace_all(text, "[[:punct:]]", " "))  #stringr

# regular expressions
add_word_boundaries <- function(word) {
  paste0("(?<!\\w)", word, "(?!\\w)")  #look behind lookaround
}


policy_regexes <- setNames(map(policy_keywords, add_word_boundaries), policy_keywords)


policy_counts <- map_dfr(names(policy_regexes), ~{
  keyword_regex <- policy_regexes[[.x]]


  obama |>
    mutate(has_word = str_detect(text, regex(keyword_regex))) |>
    summarize(policy = .x,
              count = sum(has_word))  
}) |>
  arrange(desc(count))


print(policy_counts)


```

The number of times each of the following words is found exactly like this in unique tweets. Eliminates taxpayers and other additions to the words.

```         
```
